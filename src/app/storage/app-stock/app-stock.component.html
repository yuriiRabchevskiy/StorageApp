<div class="page-wrap flex-col">
    <mat-tab-group class="storage-tab" (selectChange)="selectTab($event)">
        <mat-tab class="tab" *ngFor="let tab of tabs" [label]="tab.name">
        </mat-tab>
    </mat-tab-group>
    <p-dataTable class="stock-table" [value]="filteredData" selectionMode="single" [(selection)]="selectedItem" [loading]="showSpinner"
        [paginator]="true" [rowsPerPageOptions]="[30,50,100]" [rows]="30" [pageLinks]="4" [responsive]="true" (onRowClick)="onRowClick($event)"
        [rowStyleClass]="disabledRow" scrollable="true" scrollWidth="100%" scrollHeight="100%" [globalFilter]="gb">
        <p-header class="table-head" [ngClass]="{'mobile-t-head': view.isMobile}">
            <app-button-group [class.t-i-button-group]="view.isMobile" [minimized]="view.isMobile && canView">
                <app-i-button *ngIf="canView" icon="add-icon" title="Додати Продукт" (iClick)="showDialogToAdd()"></app-i-button>
                <app-i-button *ngIf="canView" icon="edit-icon" title="Редагувати Продукт" (iClick)="showDialogToEdit(selectedItem)"></app-i-button>
                <app-i-button *ngIf="canView" icon="copy-icon" title="Копіювати Продукт" (iClick)="duplicate()"></app-i-button>
                <app-i-button *ngIf="canView" icon="del-icon" title="Видалити Продукт" (iClick)="confirmation()"></app-i-button>
                <app-i-button *ngIf="canView" icon="addition-icon" title="Поповнити склад" (iClick)="showAdditionDialog(true)"></app-i-button>
                <app-i-button *ngIf="canView" icon="withdrawal-icon" title="Забрати зі складу" (iClick)="showRemovalDialog(true)"></app-i-button>
                <app-i-button *ngIf="canView" icon="transfer-icon" title="Перемістити продукт" (iClick)="showTransferDialog()" [disabled]="!selectedItem || !isBalance"></app-i-button>
                <app-i-button icon="sell-icon" title="Додати до кошика" (iClick)="showSellDialog()" [disabled]="!selectedItem || !isBalance"></app-i-button>
                <app-i-button icon="i-refresh" title="Оновити дані" (iClick)="refresh()"></app-i-button>
            </app-button-group>
            <div class="button-wrap">
                <app-i-button *ngIf="sellList.length > 0" icon="i-basket" title="Оформити замовлення" (iClick)="showBasketDialog()"></app-i-button>
                <input class="s-serche" #gb type="text" placeholder="Пошук">
            </div>
        </p-header>
        <p-column field="productType" header="Ім'я" [sortable]="true"></p-column>
        <p-column field="producer" header="Виробник" [sortable]="true"></p-column>
        <p-column field="model" header="Модель" [sortable]="true" [style]="{'width':'80px'}"></p-column>
        <p-column field="size" header="Розмір" [sortable]="true"></p-column>
        <p-column field="color" header="Колір" [sortable]="true"></p-column>
        <p-column field="freeNote" header="Нотатки" [sortable]="true" [style]="{'width':'300px'}"></p-column>
        <p-column field="recommendedBuyPrice" header="Ціна покупки" [sortable]="true" [style]="{'width': '110px'}">

        </p-column>
        <p-column field="recommendedSalePrice" header="Ціна продажу" [sortable]="true" [style]="{'width': '110px'}">
        </p-column>
        <p-column *ngFor="let col of wereHouses" [field]="'wh_'+col.id" [header]="col.name" [style]="{'width': '80px'}"></p-column>
    </p-dataTable>
</div>
<app-product *ngIf="displayDialog" [categories]="categories" (onCloseDialog)="closeDialog($event)" (saveProduct)="save($event)"
    [product]="selectedItem"></app-product>

<app-transfer *ngIf="transferDialog" [product]="selectedItem" [locations]="wereHouses" (onCloseDialog)="closeTransferDialog($event)"
    (transfer)="doTransfer($event)"></app-transfer>

<app-addition *ngIf="additionDialog" [product]="selectedItem" [locations]="wereHouses" (onCloseDialog)="closeAdditionDialog($event)"
    (addition)="saveAddition($event)"></app-addition>

<app-prod-removal *ngIf="removalDialog" [product]="selectedItem" [locations]="wereHouses" (onCloseDialog)="closeRemovalDialog($event)"
(removeRequested)="removeProducts($event)"> 

</app-prod-removal>

<app-sell *ngIf="sellDialog" [product]="selectedItem" [locations]="wereHouses" [sell]="sell" (onCloseDialog)="closeSellDialog($event)"
    (sale)="sale($event)"></app-sell>

<app-basket *ngIf="basketDialog" [items]="sellList" [locations]="wereHouses" (sale)="finishedSale($event)" (onCloseDialog)="closeBasketDialog($event)"
    (removeItem)="turnFromBasket($event)"></app-basket>

<app-confirm [title]="selectedItem.productType" (confirm)="confirmDelete($event)" *ngIf="showConfirm">
    <span header class="confirm-title">Ви впевнені, що бажаєте видалити продукт:
        <b>{{selectedItem.productType}}</b>
    </span>
</app-confirm>